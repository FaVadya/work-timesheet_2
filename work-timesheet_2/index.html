<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞–±–æ—á–∏–π —Ç–∞–±–µ–ª—å</title>
    <meta name="description" content="–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É—á–µ—Ç–∞ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏">
    <meta name="theme-color" content="#3b82f6"/>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä –†–∞–±–æ—á–∏–π —Ç–∞–±–µ–ª—å</h1>
            <div class="header-controls">
                <div id="connectionStatus" class="status-indicator online">
                    ‚óè –û–Ω–ª–∞–π–Ω
                </div>
                <div id="lastSaved" class="save-indicator">
                    –ó–∞–≥—Ä—É–∑–∫–∞...
                </div>
                <button id="forceSave" class="btn-secondary" title="–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ">
                    üíæ
                </button>
            </div>
        </header>

        <div class="month-navigation">
            <button id="prevMonth" class="btn">‚Äπ</button>
            <h2 id="monthYear"></h2>
            <button id="nextMonth" class="btn">‚Ä∫</button>
        </div>

        <div id="calendar" class="calendar"></div>

        <div class="projects-section">
            <h3>–ü—Ä–æ–µ–∫—Ç—ã</h3>
            <form id="projectForm" class="project-form">
                <input type="text" id="projectName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞" required>
                <input type="color" id="projectColor" value="#3b82f6">
                <button type="submit" class="btn">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
            <div id="projectsList" class="projects-list"></div>
        </div>

        <div class="stats-section">
            <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <select id="statsPeriod" class="stats-period">
                <option value="all">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</option>
                <option value="week">–ó–∞ –Ω–µ–¥–µ–ª—é</option>
                <option value="month">–ó–∞ –º–µ—Å—è—Ü</option>
                <option value="year">–ó–∞ –≥–æ–¥</option>
            </select>
            <div id="stats" class="stats"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–Ω—è -->
    <div id="dayModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="modalDate"></h3>
            
            <div class="entries-list">
                <h4>–ó–∞–ø–∏—Å–∏:</h4>
                <div id="modalEntries"></div>
            </div>
            
            <form id="addEntryForm" class="entry-form">
                <h4>–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å:</h4>
                <select id="entryProject" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç</option>
                </select>
                <input type="number" id="entryHours" step="0.5" min="0.5" max="24" placeholder="–ß–∞—Å—ã" required>
                <button type="submit" class="btn">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
    
    <script>
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ServiceWorker: ', error);
                    });
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
        function updateConnectionStatus() {
            const statusElement = document.getElementById('connectionStatus');
            if (navigator.onLine) {
                statusElement.className = 'status-indicator online';
                statusElement.textContent = '‚óè –û–Ω–ª–∞–π–Ω';
            } else {
                statusElement.className = 'status-indicator offline';
                statusElement.textContent = '‚óè –û—Ñ–ª–∞–π–Ω';
            }
        }

        window.addEventListener('online', updateConnectionStatus);
        window.addEventListener('offline', updateConnectionStatus);
        updateConnectionStatus();
    </script>
</body>
</html>